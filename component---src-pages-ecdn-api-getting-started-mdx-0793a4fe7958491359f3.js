"use strict";(self.webpackChunkexample=self.webpackChunkexample||[]).push([[7621],{64543:function(e,n,a){a.r(n),a.d(n,{_frontmatter:function(){return i},default:function(){return c}});var t=a(63366),r=(a(67294),a(64983)),s=a(56928),o=["components"],i={},l={_frontmatter:i},p=s.Z;function c(e){var n=e.components,a=(0,t.Z)(e,o);return(0,r.kt)(p,Object.assign({},l,a,{components:n,mdxType:"MDXLayout"}),(0,r.kt)("h2",null,"Introduction"),(0,r.kt)("p",null,"The IBM ECDN (Enterprise Content Delivery Network) API lets you monitor and manage your ECDN locations, servers and other resources."),(0,r.kt)("h2",null,"Try it out"),(0,r.kt)("p",null,(0,r.kt)("a",{parentName:"p",href:"https://ecdn.video.ibm.com/graphiql"},"API Browser")," is the easiest way to try ECDN’s GraphQL API.\nYou can log in via your ECDN credentials.\nGenerated documentation can be found by opening ",(0,r.kt)("inlineCode",{parentName:"p"},"Docs")," in the upper-right corner, which are also available on this site."),(0,r.kt)("h2",null,"GraphQL"),(0,r.kt)("p",null,"We suggest reading the ",(0,r.kt)("a",{parentName:"p",href:"https://graphql.org/learn/"},"official GraphQL documentation"),"\nto get a basic understanding of its usage. This documentation focuses on ECDN specific usage."),(0,r.kt)("h3",null,"All/specific resources"),(0,r.kt)("p",null,"We will use ",(0,r.kt)("inlineCode",{parentName:"p"},"servers")," and ",(0,r.kt)("inlineCode",{parentName:"p"},"locations")," throughout this document, which covers all servers and/or all locations when used.\nIf you want to query them one-by-one use ",(0,r.kt)("inlineCode",{parentName:"p"},"serverByID")," and ",(0,r.kt)("inlineCode",{parentName:"p"},"locationByID")," instead. i.e:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-graphql"},"{\n    locations {\n        id\n        name\n    }\n}\n")),(0,r.kt)("p",null,"will return ID and name of all locations, where"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-graphql"},'{\n    locationByID(id:"bG9jYXRpb246MzA1") {\n        id\n        name\n    }\n}\n')),(0,r.kt)("p",null,"will return ID and name of location with ID of ",(0,r.kt)("inlineCode",{parentName:"p"},'"bG9jYXRpb246MzA1"')," only (if it exists)."),(0,r.kt)("h3",null,"Example queries"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("p",{parentName:"li"},"Locations ID, name, external ranges and number of servers."),(0,r.kt)("pre",{parentName:"li"},(0,r.kt)("code",{parentName:"pre",className:"language-graphql"},"{\n    locations {\n        id\n        name\n        numberOfServers\n        externalRanges\n    }\n}\n"))),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("p",{parentName:"li"},"Servers ID, FQDN, CPU, memory, system disk size (in bytes), cache disk size (in bytes), IP address,\nlocation name, ECDN version with patch level and last check in date."),(0,r.kt)("pre",{parentName:"li"},(0,r.kt)("code",{parentName:"pre",className:"language-graphql"},"{\n    servers {\n        id\n        fqdn\n        lastCheckIn\n        location {\n            name\n        }\n        update {\n            ecdnVersion\n            patchLevel\n        }\n        hardware {\n            cpuCores\n            memory\n            systemDiskSize\n            cacheDiskSize\n        }\n        desiredConfiguration {\n            interfaces{\n                localIP\n            }\n        }\n    }\n}\n"))),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("p",{parentName:"li"},"Servers ID, FQDN, detailed health and status of video delivery."),(0,r.kt)("pre",{parentName:"li"},(0,r.kt)("code",{parentName:"pre",className:"language-graphql"},"{\n    servers {\n        id\n        fqdn\n        health {\n            contentDelivery {\n                aggregated\n                upstreams\n                caching\n            }\n            operations {\n                aggregated\n                updates\n                softwareVersion\n                apiConnection\n                metrics\n                ntp\n                logForward\n                remoteAssistance\n                snmp\n            }\n        }\n        videoDelivery {\n            currentNumberOfViewers\n            currentNumberOfBuffering\n        }\n    }\n}\n")))),(0,r.kt)("h2",null,"Basic workflow"),(0,r.kt)("ol",null,(0,r.kt)("li",{parentName:"ol"},(0,r.kt)("p",{parentName:"li"},"Fetch tokens."),(0,r.kt)("pre",{parentName:"li"},(0,r.kt)("code",{parentName:"pre",className:"language-sh"},'curl \'https://api.ecdn.video.ibm.com/v1/login\' \\\n    -d \'{"email":"...","password":"..."}\'\n')),(0,r.kt)("p",{parentName:"li"},"Returns:"),(0,r.kt)("pre",{parentName:"li"},(0,r.kt)("code",{parentName:"pre",className:"language-json"},'{\n    # JWT token, see https://jwt.io.\n    "accessToken": "YOUR_ACCESS_TOKEN",\n    # This can only be used once.\n    "refreshToken": "YOUR_REFRESH_TOKEN",\n    # Currently, refresh token expires in one day.\n    "refreshAgeSeconds": 86400\n}\n'))),(0,r.kt)("li",{parentName:"ol"},(0,r.kt)("p",{parentName:"li"},"Use API with access token. Note that all if you had a query ",(0,r.kt)("inlineCode",{parentName:"p"},"{servers{id}}")," at API Browser,\nyou must send it as ",(0,r.kt)("inlineCode",{parentName:"p"},'\'{"query":"{servers{id}}"}\'')," if you use the API directly."),(0,r.kt)("pre",{parentName:"li"},(0,r.kt)("code",{parentName:"pre",className:"language-sh"},"curl -H 'Authorization: Bearer YOUR_ACCESS_TOKEN' \\\n    https://api.ecdn.video.ibm.com/v1/graphql \\\n    -d '{\"query\":\"{servers{id}}\"}'\n"))),(0,r.kt)("li",{parentName:"ol"},(0,r.kt)("p",{parentName:"li"},"Refresh tokens. Currently your access token expires in 5 minutes.\nThe actual expiration time can be extracted from ",(0,r.kt)("a",{parentName:"p",href:"https://jwt.io"},"JWT"),"’s ",(0,r.kt)("inlineCode",{parentName:"p"},"exp")," field.\nTherefore, you must use your refresh token to request a new access token before/if it expires."),(0,r.kt)("pre",{parentName:"li"},(0,r.kt)("code",{parentName:"pre",className:"language-sh"},"curl 'https://api.ecdn.video.ibm.com/v1/token/refresh' \\\n    -d '{\"refreshToken\":\"YOUR_REFRESH_TOKEN\"}'\n")),(0,r.kt)("p",{parentName:"li"},"Returns:"),(0,r.kt)("pre",{parentName:"li"},(0,r.kt)("code",{parentName:"pre",className:"language-json"},'{\n    # JWT token, see https://jwt.io.\n    "accessToken": "YOUR_NEW_ACCESS_TOKEN",\n    # This can only be used once.\n    "refreshToken": "YOUR_NEW_REFRESH_TOKEN",\n    # Currently, refresh token expires in one day.\n    "refreshAgeSeconds": 86400\n}\n')))))}c.isMDXComponent=!0}}]);
//# sourceMappingURL=component---src-pages-ecdn-api-getting-started-mdx-0793a4fe7958491359f3.js.map