{
    "componentChunkName": "component---src-pages-viewer-authentication-api-implementing-viewer-authentication-mdx",
    "path": "/viewer-authentication-api-implementing-viewer-authentication/",
    "result": {"pageContext":{"frontmatter":{"title":"Deprecated - Implementing viewer authentication","description":"Deprecated - Implementing viewer authentication"},"relativePagePath":"/viewer-authentication-api-implementing-viewer-authentication.mdx","titleType":"page","MdxNode":{"id":"f377aa3e-961a-530a-be6f-99b44d9280ca","children":[],"parent":"302e4331-1362-54b7-bd7e-f0cb19577a7d","internal":{"content":"---\ntitle: Deprecated - Implementing viewer authentication\ndescription: Deprecated - Implementing viewer authentication\n---\n\n<InlineNotification kind=\"warning\">\n\n**Deprecation Warning:** This API is deprecated and it is scheduled to be removed on 03/01/2022. Please use (or migrate to) the new version of the [Viewer Authentication](/viewer-authentication-api-v2-getting-started).\n\n</InlineNotification>\n\n## Channel level\n\n```\nPUT\thttps://api.video.ibm.com/channels/CHANNEL_ID/locks/hash/advanced.json\n```\n\n<Title>Parameters</Title>\n\n| PARAMETER | TYPE   | IMPORTANCE | DESCRIPTION                                |\n| --------- | ------ | ---------- | ------------------------------------------ |\n| `url`     | string | REQUIRED   | URL of the authentication flow entry point |\n| `secret`  | string | REQUIRED   | Secret key                                 |\n\n<Title>Response</Title>\n\nHTTP response codes returned when the action is successful:\n\n| HTTP RESPONSE CODE | DESCRIPTION                                                                                          |\n| ------------------ | ---------------------------------------------------------------------------------------------------- |\n| 201 Created        | Viewer authentication has been set up on the channel with the new hash.                              |\n| 204 No Content     | Viewer authentication has been set up on the channel by updating the existing hash with the new one. |\n\nSpecific error codes returned when the action failed:\n\n| ERROR VALUE         | HTTP RESPONSE   | CODE DESCRIPTION                                           |\n| ------------------- | --------------- | ---------------------------------------------------------- |\n| `invalid_request`   | 400 Bad Request | One or more required parameters are missing (secret, url). |\n| `invalid_type`      | 400 Bad Request | The URL is invalid.                                        |\n| `lack_of_ownership` | 403 Forbidden   | The api user is not allowed to manage the given channel    |\n| `not_found`         | 404 Not found   | Channel not found                                          |\n\n## Video level\n\nBy default videos inherit the authentication settings from channels but it can be overridden on a video by video basis.\n\n### Set up viewer authentication for a video\n\n```\nPUT\thttps://api.video.ibm.com/videos/VIDEO_ID/locks/hash.json\n```\n\n<Title>Parameters</Title>\n\n| PARAMETER | TYPE   | IMPORTANCE | DESCRIPTION                                |\n| --------- | ------ | ---------- | ------------------------------------------ |\n| `url`     | string | REQUIRED   | URL of the authentication flow entry point |\n| `secret`  | string | REQUIRED   | Secret key                                 |\n\n<Title>Response</Title>\n\nHTTP response code returned when the action is successful:\n\n| HTTP RESPONSE CODE | DESCRIPTION                                        |\n| ------------------ | -------------------------------------------------- |\n| 204 No content     | Viewer authentication has been set up on the video |\n\n## Implementing the authentication response\n\nIf the authentication was successful, your service must pass an authentication response to the player. The authentication response must be a JSON encoded array which contains the following:\n\n- list of parameters that have been hashed\n- the MD5 hash of the string that has been created by concatenating the parameters and the shared secret key with pipe \"|\" characters\n\nExample script in PHP for creating the authentication response when the authentication was successful\n\n```js\n// We create the array of parameters.\n// The parameters can be anything.\n$userData = [\n    \"user\" => $_SESSION[\"user\"],\n    \"someString\" => \"someValue\"\n];\n\n// We create the hash by hashing\n// the parameters array contents and\n// the secret key\n// concatenated together with a pipe character.\n$hash = md5(implode('|', $userData) . '|' . $SHARED_SECRET_KEY);\n\n// We put the array of parameters and the hash into the response.\n$response = array_chunk(\n    array_merge($userData, [\"hash\" => $hash]),\n    1,\n    true\n);\n\n// We encode the response into JSON format.\n$json = json_encode($response);\n```\n\n<InlineNotification kind=\"info\">\n  The order of the parameters should match their order in the array when creating the hash.\n</InlineNotification>\n\nTo pass the response to the player your service must redirect the page to the IBM Video Streaming return URL with passing the response in JSON format as a get parameter. You can test the API response at the [Hash Authentication Test](/viewer-authentication-api-hash-authentication-test) page.\n\n```\nhttps://video.ibm.com/embed/hashlock/pass?hash=RESPONSE_IN_JSON_FORMAT\n```\n\n## Managing viewer authentication settings\n\n### Getting channel viewer authentication settings\n\n```\nGET\thttps://api.video.ibm.com/channels/CHANNEL_ID/locks/hash.json\n```\n\n#### Parameters\n\nThis request has no parameters.\n\n#### Response\n\nUpon success, key-value pairs are returned under a \"hashlock\" key.\n\nExample:\n\n```json\n{\n  \"hashlock\": {\n    \"type\": \"advanced\",\n    \"url\": \"https://yourdomain.com/auth/123\",\n    \"message\": null,\n    \"button_caption\": null,\n    \"popup_width\": \"0\",\n    \"popup_height\": \"0\"\n  }\n}\n```\n\nSpecific error codes returned when the action failed:\n\n| ERROR VALUE         | HTTP RESPONSE CODE | DESCRIPTION                                             |\n| ------------------- | ------------------ | ------------------------------------------------------- |\n| `lack_of_ownership` | 403 Forbidden      | The API user is not allowed to manage the given channel |\n| `not_found`         | 404 Not found      | Channel not found                                       |\n\n### Removing channel viewer authentication\n\n```\nDELETE\thttps://api.video.ibm.com/channels/CHANNEL_ID/locks/hash.json\n```\n\n#### Parameters\n\nThis request has no parameters.\n\n#### Response\n\nUpon success the 200 OK HTTP response code is returned.\n\nSpecific error codes returned when the action failed:\n\n| ERROR VALUE         | HTTP RESPONSE CODE | DESCRIPTION                                             |\n| ------------------- | ------------------ | ------------------------------------------------------- |\n| `lack_of_ownership` | 403 Forbidden      | The api user is not allowed to manage the given channel |\n| `not_found`         | 404 Not found      | Channel not found                                       |\n\n### Getting video viewer authentication settings\n\n```\nGET\thttps://api.video.ibm.com/videos/VIDEO_ID/locks/hash.json\n```\n\n#### Parameters\n\nThis request has no parameters.\n\n#### Response\n\nUpon success, key-value pairs are returned under a \"hashlock\" key.\n\n<Title>Example</Title>\n\n```json\n{\n  \"hashlock\": {\n    \"url\": \"https://auth.yourdomain.com/video-authentication\",\n    \"secret\": \"TOP_SECRET_KEY\"\n  }\n}\n```\n\nSpecific error codes returned when the action failed:\n\n| ERROR VALUE         | HTTP RESPONSE CODE | DESCRIPTION                                             |\n| ------------------- | ------------------ | ------------------------------------------------------- |\n| `lack_of_ownership` | 403 Forbidden      | The api user is not allowed to manage the given channel |\n| `not_found`         | 404 Not found      | Video or specific authentication settings not found     |\n\n### Removing specific video viewer authentication settings\n\nIf you remove specific settings then video will inherit the authentication settings from the channel.\n\n```\nDELETE\thttps://api.video.ibm.com/videos/VIDEO_ID/locks/hash.json\n```\n\n#### Parameters\n\nThis request has no parameters.\n\n#### Response\n\nUpon success the 204 No Content HTTP response code is returned.\n\nSpecific error codes returned when the action failed:\n\n| ERROR VALUE         | HTTP RESPONSE CODE | DESCRIPTION                                             |\n| ------------------- | ------------------ | ------------------------------------------------------- |\n| `lack_of_ownership` | 403 Forbidden      | The api user is not allowed to manage the given channel |\n| `not_found`         | 404 Not found      | Video or specific authentication settings not foun      |\n","type":"Mdx","contentDigest":"5481877a9b87eafa7cea90b675332b0d","owner":"gatsby-plugin-mdx","counter":362},"frontmatter":{"title":"Deprecated - Implementing viewer authentication","description":"Deprecated - Implementing viewer authentication"},"exports":{},"rawBody":"---\ntitle: Deprecated - Implementing viewer authentication\ndescription: Deprecated - Implementing viewer authentication\n---\n\n<InlineNotification kind=\"warning\">\n\n**Deprecation Warning:** This API is deprecated and it is scheduled to be removed on 03/01/2022. Please use (or migrate to) the new version of the [Viewer Authentication](/viewer-authentication-api-v2-getting-started).\n\n</InlineNotification>\n\n## Channel level\n\n```\nPUT\thttps://api.video.ibm.com/channels/CHANNEL_ID/locks/hash/advanced.json\n```\n\n<Title>Parameters</Title>\n\n| PARAMETER | TYPE   | IMPORTANCE | DESCRIPTION                                |\n| --------- | ------ | ---------- | ------------------------------------------ |\n| `url`     | string | REQUIRED   | URL of the authentication flow entry point |\n| `secret`  | string | REQUIRED   | Secret key                                 |\n\n<Title>Response</Title>\n\nHTTP response codes returned when the action is successful:\n\n| HTTP RESPONSE CODE | DESCRIPTION                                                                                          |\n| ------------------ | ---------------------------------------------------------------------------------------------------- |\n| 201 Created        | Viewer authentication has been set up on the channel with the new hash.                              |\n| 204 No Content     | Viewer authentication has been set up on the channel by updating the existing hash with the new one. |\n\nSpecific error codes returned when the action failed:\n\n| ERROR VALUE         | HTTP RESPONSE   | CODE DESCRIPTION                                           |\n| ------------------- | --------------- | ---------------------------------------------------------- |\n| `invalid_request`   | 400 Bad Request | One or more required parameters are missing (secret, url). |\n| `invalid_type`      | 400 Bad Request | The URL is invalid.                                        |\n| `lack_of_ownership` | 403 Forbidden   | The api user is not allowed to manage the given channel    |\n| `not_found`         | 404 Not found   | Channel not found                                          |\n\n## Video level\n\nBy default videos inherit the authentication settings from channels but it can be overridden on a video by video basis.\n\n### Set up viewer authentication for a video\n\n```\nPUT\thttps://api.video.ibm.com/videos/VIDEO_ID/locks/hash.json\n```\n\n<Title>Parameters</Title>\n\n| PARAMETER | TYPE   | IMPORTANCE | DESCRIPTION                                |\n| --------- | ------ | ---------- | ------------------------------------------ |\n| `url`     | string | REQUIRED   | URL of the authentication flow entry point |\n| `secret`  | string | REQUIRED   | Secret key                                 |\n\n<Title>Response</Title>\n\nHTTP response code returned when the action is successful:\n\n| HTTP RESPONSE CODE | DESCRIPTION                                        |\n| ------------------ | -------------------------------------------------- |\n| 204 No content     | Viewer authentication has been set up on the video |\n\n## Implementing the authentication response\n\nIf the authentication was successful, your service must pass an authentication response to the player. The authentication response must be a JSON encoded array which contains the following:\n\n- list of parameters that have been hashed\n- the MD5 hash of the string that has been created by concatenating the parameters and the shared secret key with pipe \"|\" characters\n\nExample script in PHP for creating the authentication response when the authentication was successful\n\n```js\n// We create the array of parameters.\n// The parameters can be anything.\n$userData = [\n    \"user\" => $_SESSION[\"user\"],\n    \"someString\" => \"someValue\"\n];\n\n// We create the hash by hashing\n// the parameters array contents and\n// the secret key\n// concatenated together with a pipe character.\n$hash = md5(implode('|', $userData) . '|' . $SHARED_SECRET_KEY);\n\n// We put the array of parameters and the hash into the response.\n$response = array_chunk(\n    array_merge($userData, [\"hash\" => $hash]),\n    1,\n    true\n);\n\n// We encode the response into JSON format.\n$json = json_encode($response);\n```\n\n<InlineNotification kind=\"info\">\n  The order of the parameters should match their order in the array when creating the hash.\n</InlineNotification>\n\nTo pass the response to the player your service must redirect the page to the IBM Video Streaming return URL with passing the response in JSON format as a get parameter. You can test the API response at the [Hash Authentication Test](/viewer-authentication-api-hash-authentication-test) page.\n\n```\nhttps://video.ibm.com/embed/hashlock/pass?hash=RESPONSE_IN_JSON_FORMAT\n```\n\n## Managing viewer authentication settings\n\n### Getting channel viewer authentication settings\n\n```\nGET\thttps://api.video.ibm.com/channels/CHANNEL_ID/locks/hash.json\n```\n\n#### Parameters\n\nThis request has no parameters.\n\n#### Response\n\nUpon success, key-value pairs are returned under a \"hashlock\" key.\n\nExample:\n\n```json\n{\n  \"hashlock\": {\n    \"type\": \"advanced\",\n    \"url\": \"https://yourdomain.com/auth/123\",\n    \"message\": null,\n    \"button_caption\": null,\n    \"popup_width\": \"0\",\n    \"popup_height\": \"0\"\n  }\n}\n```\n\nSpecific error codes returned when the action failed:\n\n| ERROR VALUE         | HTTP RESPONSE CODE | DESCRIPTION                                             |\n| ------------------- | ------------------ | ------------------------------------------------------- |\n| `lack_of_ownership` | 403 Forbidden      | The API user is not allowed to manage the given channel |\n| `not_found`         | 404 Not found      | Channel not found                                       |\n\n### Removing channel viewer authentication\n\n```\nDELETE\thttps://api.video.ibm.com/channels/CHANNEL_ID/locks/hash.json\n```\n\n#### Parameters\n\nThis request has no parameters.\n\n#### Response\n\nUpon success the 200 OK HTTP response code is returned.\n\nSpecific error codes returned when the action failed:\n\n| ERROR VALUE         | HTTP RESPONSE CODE | DESCRIPTION                                             |\n| ------------------- | ------------------ | ------------------------------------------------------- |\n| `lack_of_ownership` | 403 Forbidden      | The api user is not allowed to manage the given channel |\n| `not_found`         | 404 Not found      | Channel not found                                       |\n\n### Getting video viewer authentication settings\n\n```\nGET\thttps://api.video.ibm.com/videos/VIDEO_ID/locks/hash.json\n```\n\n#### Parameters\n\nThis request has no parameters.\n\n#### Response\n\nUpon success, key-value pairs are returned under a \"hashlock\" key.\n\n<Title>Example</Title>\n\n```json\n{\n  \"hashlock\": {\n    \"url\": \"https://auth.yourdomain.com/video-authentication\",\n    \"secret\": \"TOP_SECRET_KEY\"\n  }\n}\n```\n\nSpecific error codes returned when the action failed:\n\n| ERROR VALUE         | HTTP RESPONSE CODE | DESCRIPTION                                             |\n| ------------------- | ------------------ | ------------------------------------------------------- |\n| `lack_of_ownership` | 403 Forbidden      | The api user is not allowed to manage the given channel |\n| `not_found`         | 404 Not found      | Video or specific authentication settings not found     |\n\n### Removing specific video viewer authentication settings\n\nIf you remove specific settings then video will inherit the authentication settings from the channel.\n\n```\nDELETE\thttps://api.video.ibm.com/videos/VIDEO_ID/locks/hash.json\n```\n\n#### Parameters\n\nThis request has no parameters.\n\n#### Response\n\nUpon success the 204 No Content HTTP response code is returned.\n\nSpecific error codes returned when the action failed:\n\n| ERROR VALUE         | HTTP RESPONSE CODE | DESCRIPTION                                             |\n| ------------------- | ------------------ | ------------------------------------------------------- |\n| `lack_of_ownership` | 403 Forbidden      | The api user is not allowed to manage the given channel |\n| `not_found`         | 404 Not found      | Video or specific authentication settings not foun      |\n","fileAbsolutePath":"/home/runner/work/video-streaming-developer-docs/video-streaming-developer-docs/src/pages/viewer-authentication-api-implementing-viewer-authentication.mdx"}}},
    "staticQueryHashes": ["1364590287","137577622","2102389209","2203542295","2746626797","3037994772","559098832","768070550"]}